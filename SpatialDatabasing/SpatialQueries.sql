-- Database: UscCampus

-- DROP DATABASE IF EXISTS "UscCampus";

-- CREATE PLACES TABLE
CREATE TABLE Places (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    location GEOMETRY(Point, 4326)
);

INSERT INTO Places (name, location)
VALUES
    ('Doheny Blue Light', ST_GeomFromText('POINT(-118.2833765399337 34.01969740240152)', 4326)),
    ('RTC Blue Light', ST_GeomFromText('POINT(-118.28575258154264 34.01976463853764)', 4326)),
    ('Viterbi Blue Light', ST_GeomFromText('POINT(-118.2873548661529 34.019568921098504)', 4326)),
    ('Starbucks', ST_GeomFromText('POINT(-118.28265848580587 34.02136503721962)', 4326)),
	('Dulce', ST_GeomFromText('POINT(-118.28515158510426 34.02540882207765)', 4326)),
    ('Equator Coffees', ST_GeomFromText('POINT(-118.28246703832613 34.01902010986181)', 4326)),
	('Marshall Gate', ST_GeomFromText('POINT(-118.2833674329244 34.01853851277321)', 4326)),
    ('McCarthy Gate', ST_GeomFromText('POINT(-118.28136985201225 34.02060136202166)', 4326)),
	('Hoover Gate', ST_GeomFromText('POINT(-118.2835816149971 34.02285781172763)', 4326)),
    ('Neil Armstrong', ST_GeomFromText('POINT(-118.28846873726536 34.020267636546976)', 4326)),
	('Tire Biter', ST_GeomFromText('POINT(-118.28623806137432 34.018921796264145)', 4326)),
    ('Douglas Fairbanks', ST_GeomFromText('POINT(-118.28640301722874 34.02337325740058)', 4326)),
	('Home', ST_GeomFromText('POINT(-118.292806 34.029389)', 4326));  

-- CONVEX HULL QUERY

SELECT ST_AsText(ST_ConvexHull(ST_Collect(location)))
FROM Places;

-- output: "POLYGON((-118.2833674329244 34.01853851277321,-118.28623806137432 34.018921796264145,-118.2873548661529 34.019568921098504,-118.28846873726536 34.020267636546976,-118.292806 34.029389,-118.28515158510426 34.02540882207765,-118.28136985201225 34.02060136202166,-118.28246703832613 34.01902010986181,-118.2833674329244 34.01853851277321))"

SELECT name, ST_AsText(location)
FROM Places
ORDER BY location <-> ST_GeomFromText('POINT(-118.292806 34.029389)', 4326)
LIMIT 5;

-- MADE LIMIT 5 SINCE HOME IS IN TABLE, THE OTHER 4 ARE THE CLOSEST TO HOME
